<div class="app">
  <header class="header">
    <div class="window-controls">
      <div class="window-control close-btn"></div>
      <div class="window-control"></div>
    </div>
    <div class="logo">ğŸ“Ÿ SUMI</div>
    <div class="header-status">
      <div class="status-badge">
        <span class="status-dot" id="statusDot"></span>
        <span id="headerStatus">Checking...</span>
      </div>
      <span id="headerBattery">ğŸ”‹ --%</span>
    </div>
  </header>
  
  <div class="main">
    <nav class="sidebar" id="sidebar">
      <div class="nav-section">
        <div class="nav-section-title">Setup</div>
        <div class="nav-item active" data-page="home"><span class="nav-icon">ğŸ </span>Dashboard</div>
        <div class="nav-item" data-page="builder"><span class="nav-icon">ğŸ¨</span>Customize</div>
        <div class="nav-item" data-page="wifi"><span class="nav-icon">ğŸ“¶</span>WiFi</div>
      </div>
      <div class="nav-section">
        <div class="nav-section-title">Content</div>
        <div class="nav-item" data-page="files"><span class="nav-icon">ğŸ“</span>Files</div>
      </div>
      <div class="nav-section">
        <div class="nav-section-title">Settings</div>
        <div class="nav-item" data-page="weather"><span class="nav-icon">ğŸŒ¤ï¸</span>Weather</div>
        <div class="nav-item" data-page="display"><span class="nav-icon">ğŸ–¥ï¸</span>Display</div>
        <div class="nav-item" data-page="bluetooth"><span class="nav-icon">âŒ¨ï¸</span>Keyboard</div>
        <div class="nav-item" data-page="power"><span class="nav-icon">ğŸ”‹</span>Power</div>
        <div class="nav-item" data-page="about"><span class="nav-icon">â„¹ï¸</span>About</div>
      </div>
    </nav>
    
    <main class="content">
      <!-- ==================== HOME PAGE ==================== -->
      <div class="page active" id="page-home">
        <div class="page-header">
          <h1 class="page-title">Welcome to Sumi</h1>
          <p class="page-desc">Your e-ink companion is ready to be configured</p>
        </div>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">ğŸ”‹</div>
            <div class="stat-value" id="statBattery">--%</div>
            <div class="stat-label">Battery</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ’¾</div>
            <div class="stat-value" id="statStorage">--</div>
            <div class="stat-label">Storage</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ“¶</div>
            <div class="stat-value" id="statWifi">--</div>
            <div class="stat-label">WiFi</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">â±ï¸</div>
            <div class="stat-value" id="statUptime">--</div>
            <div class="stat-label">Uptime</div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <span class="card-title">Quick Setup</span>
          </div>
          <div class="card-body">
            <p class="text-muted mb-8">Get started with these essential steps:</p>
            <div class="btn-group" style="display:grid;grid-template-columns:repeat(2,1fr);gap:8px;">
              <button class="btn btn-primary" onclick="showPage('wifi')">ğŸ“¶ Connect WiFi</button>
              <button class="btn btn-secondary" onclick="showPage('builder')">ğŸ¨ Customize</button>
              <button class="btn btn-secondary" onclick="showPage('files')">ğŸ“ Manage Files</button>
              <button class="btn btn-secondary" onclick="showPage('bluetooth')">âŒ¨ï¸ Pair Keyboard</button>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <span class="card-title">Device Info</span>
          </div>
          <div class="card-body">
            <table style="width:100%;font-size:11px;">
              <tr><td class="text-muted" style="padding:6px 0">Firmware</td><td style="text-align:right" id="infoFirmware">--</td></tr>
              <tr><td class="text-muted" style="padding:6px 0">Display</td><td style="text-align:right">4.26" 800Ã—480 E-Ink</td></tr>
              <tr><td class="text-muted" style="padding:6px 0">IP Address</td><td style="text-align:right" id="infoIP">--</td></tr>
              <tr><td class="text-muted" style="padding:6px 0">Free Memory</td><td style="text-align:right" id="infoMem">--</td></tr>
            </table>
          </div>
        </div>
      </div>

      <!-- ==================== BUILDER PAGE ==================== -->
      <div class="page" id="page-builder">
        <div class="page-header">
          <h1 class="page-title">Customize Your Sumi</h1>
          <p class="page-desc">Choose your apps, theme, and layout</p>
        </div>
        
        <div class="builder-layout">
          <div class="builder-options">
            <div class="builder-tabs">
              <div class="builder-tab active" onclick="showBuilderTab('apps')">ğŸ“± Apps</div>
              <div class="builder-tab" onclick="showBuilderTab('theme')">ğŸ¨ Theme</div>
              <div class="builder-tab" onclick="showBuilderTab('layout')">ğŸ“ Layout</div>
              <div class="builder-tab" onclick="showBuilderTab('sleep')">ğŸ˜´ Sleep</div>
            </div>
            
            <!-- APPS TAB -->
            <div class="builder-panel active" id="panel-apps">
              <p class="text-muted mb-8">Select apps for your home screen:</p>
              
              <div class="plugin-category">
                <h4>Core Apps</h4>
                <div class="plugin-grid" id="plugins-core"></div>
              </div>
              
              <div class="plugin-category">
                <h4>Games</h4>
                <div class="plugin-grid" id="plugins-games"></div>
              </div>
              
              <div class="plugin-category">
                <h4>Tools</h4>
                <div class="plugin-grid" id="plugins-tools"></div>
              </div>
              
              <div class="plugin-category">
                <h4>Widgets</h4>
                <div class="plugin-grid" id="plugins-widgets"></div>
                <div id="wifiWarning" style="display:none;"></div>
              </div>
              
              <div class="plugin-category">
                <h4>System</h4>
                <div class="plugin-grid" id="plugins-system"></div>
              </div>
            </div>
            
            <!-- THEME TAB -->
            <div class="builder-panel" id="panel-theme">
              <div class="option-section">
                <h3>Color Theme</h3>
                <div class="style-options">
                  <div class="style-option selected" onclick="selectTheme(0)">
                    <div class="theme-preview light"></div>
                    <span>Light</span>
                  </div>
                  <div class="style-option" onclick="selectTheme(1)">
                    <div class="theme-preview dark"></div>
                    <span>Dark</span>
                  </div>
                  <div class="style-option" onclick="selectTheme(2)">
                    <div class="theme-preview contrast"></div>
                    <span>Contrast</span>
                  </div>
                </div>
              </div>
              
              <div class="option-section">
                <h3>Icon Style</h3>
                <div class="style-options">
                  <div class="style-option selected" onclick="selectIconStyle('rounded')">
                    <div class="icon-preview rounded">A</div>
                    <span>Rounded</span>
                  </div>
                  <div class="style-option" onclick="selectIconStyle('square')">
                    <div class="icon-preview square">A</div>
                    <span>Square</span>
                  </div>
                  <div class="style-option" onclick="selectIconStyle('circle')">
                    <div class="icon-preview circle">A</div>
                    <span>Circle</span>
                  </div>
                </div>
              </div>
              
              <div class="option-section">
                <h3>Font Size</h3>
                <div class="slider-row">
                  <label>Label Size:</label>
                  <input type="range" id="fontSizeSlider" min="10" max="18" value="12" oninput="updateFontSize(this.value)">
                  <span class="value" id="fontSizeVal">12px</span>
                </div>
              </div>
            </div>
            
            <!-- LAYOUT TAB -->
            <div class="builder-panel" id="panel-layout">
              <div class="option-section">
                <h3>Orientation</h3>
                <div class="style-options" style="grid-template-columns: repeat(2, 1fr);">
                  <div class="style-option" onclick="selectOrientation('landscape')">
                    <div class="orient-preview" style="width:40px;height:24px;"></div>
                    <span>Landscape</span>
                  </div>
                  <div class="style-option selected" onclick="selectOrientation('portrait')">
                    <div class="orient-preview" style="width:24px;height:40px;"></div>
                    <span>Portrait</span>
                  </div>
                </div>
              </div>
              
              <div class="option-section">
                <h3>Status Bar</h3>
                <div class="toggle"><span class="toggle-label">Show Status Bar</span><div class="toggle-switch on" id="togStatusBar" onclick="toggleBuilder(this,'showStatusBar')"></div></div>
                <div class="toggle"><span class="toggle-label">Show Battery</span><div class="toggle-switch on" id="togBattery" onclick="toggleBuilder(this,'showBattery')"></div></div>
                <div class="toggle"><span class="toggle-label">Show Clock</span><div class="toggle-switch on" id="togClock" onclick="toggleBuilder(this,'showClock')"></div></div>
                <div class="toggle"><span class="toggle-label">Show WiFi</span><div class="toggle-switch" id="togWifi" onclick="toggleBuilder(this,'showWifi')"></div></div>
              </div>
            </div>
            
            <!-- SLEEP SCREEN TAB -->
            <div class="builder-panel" id="panel-sleep">
              <div class="option-section">
                <h3>Sleep Display</h3>
                <div class="style-options">
                  <div class="style-option" onclick="selectSleepStyle('book')">
                    <div style="font-size:18px;">ğŸ“•</div>
                    <span>Book Cover</span>
                  </div>
                  <div class="style-option" onclick="selectSleepStyle('shuffle')">
                    <div style="font-size:18px;">ğŸ”€</div>
                    <span>Shuffle</span>
                  </div>
                  <div class="style-option selected" onclick="selectSleepStyle('off')">
                    <div style="font-size:18px;">ğŸ’¤</div>
                    <span>Wake Me</span>
                  </div>
                </div>
              </div>
              
              <div class="option-section">
                <h3>Sleep Options</h3>
                <div class="toggle"><span class="toggle-label">Show Battery Warning</span><div class="toggle-switch on" id="togSleepBattery" onclick="toggleBuilder(this,'showBatterySleep')"></div></div>
              </div>
              
              <div class="option-section">
                <h3>Wake Button</h3>
                <select id="wakeButton" onchange="builderConfig.wakeButton=this.value" style="width:100%;">
                  <option value="any">Any Button</option>
                  <option value="select">Select Button Only</option>
                  <option value="power">Power Button Only</option>
                </select>
              </div>
            </div>
          </div>
          
          <!-- PREVIEW -->
          <div class="builder-preview">
            <div class="preview-header">
              <span>ğŸ“± Live Preview</span>
              <span class="preview-badge" id="previewBadge">Home</span>
            </div>
            <div class="preview-tabs">
              <div class="preview-tab active" onclick="setPreviewMode('home')">ğŸ  Home</div>
              <div class="preview-tab" onclick="setPreviewMode('sleep')">ğŸ˜´ Sleep</div>
            </div>
            <div class="device-container">
              <div class="device-outer portrait" id="deviceFrame">
                <div class="device-inner">
                  <div class="eink-screen light" id="einkScreen"></div>
                </div>
              </div>
            </div>
            <div style="text-align:center;margin-top:8px;">
              <button class="btn btn-sm" onclick="togglePreviewOrientation()">ğŸ”„ Rotate</button>
            </div>
            <div id="previewStats" style="margin-top:6px;text-align:center;font-size:9px;color:var(--mac-gray-dark)"></div>
          </div>
        </div>
      </div>

      <!-- ==================== WIFI PAGE ==================== -->
      <div class="page" id="page-wifi">
        <div class="page-header">
          <h1 class="page-title">WiFi Settings</h1>
          <p class="page-desc">Connect to your home network</p>
        </div>
        
        <div class="card">
          <div class="card-header">
            <span class="card-title">Current Connection</span>
          </div>
          <div class="card-body">
            <div id="wifiStatus">Checking...</div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <span class="card-title">Available Networks</span>
            <button class="btn btn-sm btn-secondary" onclick="scanWifi()" id="wifiScanBtn">ğŸ” Scan</button>
          </div>
          <div class="card-body" style="padding:0;">
            <div id="wifiList" class="list-view" style="min-height:100px;border:none;">
              <div style="padding:20px;text-align:center;color:var(--mac-gray-dark);">Click Scan to find networks</div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== FILES PAGE ==================== -->
      <div class="page" id="page-files">
        <div class="page-header">
          <h1 class="page-title">File Manager</h1>
          <p class="page-desc">Manage your books, images, and more</p>
        </div>
        
        <div class="file-tabs">
          <div class="file-tab active" onclick="showFileTab('books')">ğŸ“š Books <span class="count" id="countBooks">0</span></div>
          <div class="file-tab" onclick="showFileTab('images')">ğŸ–¼ï¸ Images <span class="count" id="countImages">0</span></div>
          <div class="file-tab" onclick="showFileTab('maps')">ğŸ—ºï¸ Maps <span class="count" id="countMaps">0</span></div>
          <div class="file-tab" onclick="showFileTab('flashcards')">ğŸ´ Cards <span class="count" id="countFlashcards">0</span></div>
          <div class="file-tab" onclick="showFileTab('notes')">ğŸ“ Notes <span class="count" id="countNotes">0</span></div>
        </div>
        
        <!-- Books Panel -->
        <div class="file-panel active" id="panel-books">
          <div class="upload-zone" onclick="this.querySelector('input').click()" ondragover="event.preventDefault();this.classList.add('dragover')" ondragleave="this.classList.remove('dragover')" ondrop="handleDrop(event,'books')">
            <div class="icon">ğŸ“š</div>
            <div class="text">Drop books here or click to upload</div>
            <div class="hint">Supports: EPUB, PDF, TXT</div>
            <input type="file" accept=".epub,.pdf,.txt" multiple onchange="uploadFiles(this.files,'books')">
          </div>
          <div class="card">
            <div class="card-header">
              <span class="card-title">Your Books</span>
              <button class="btn btn-sm btn-secondary" onclick="refreshFiles('books')">ğŸ”„</button>
            </div>
            <div class="card-body">
              <div class="file-grid" id="bookGrid">
                <div class="file-empty"><div class="icon">ğŸ“š</div><div>No books yet</div></div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-header"><span class="card-title">Reader Settings</span></div>
            <div class="card-body">
              <div style="display:grid;grid-template-columns:1fr 180px;gap:12px;">
                <div>
                  <div class="slider-row">
                    <span class="slider-label">Font Size</span>
                    <input type="range" class="slider-input" id="readerFontSize" min="12" max="32" value="18" oninput="updateReaderPreview()">
                    <span class="slider-value" id="readerFontVal">18px</span>
                  </div>
                  <div class="slider-row">
                    <span class="slider-label">Line Height</span>
                    <input type="range" class="slider-input" id="readerLineHeight" min="100" max="200" step="10" value="150" oninput="updateReaderPreview()">
                    <span class="slider-value" id="readerLineVal">150%</span>
                  </div>
                  <div class="slider-row">
                    <span class="slider-label">Margins</span>
                    <input type="range" class="slider-input" id="readerMargins" min="5" max="40" value="20" oninput="updateReaderPreview()">
                    <span class="slider-value" id="readerMarginVal">20px</span>
                  </div>
                  <div class="toggle">
                    <span class="toggle-label">Justify Text</span>
                    <div class="toggle-switch on" id="togJustify" onclick="toggleReaderOpt(this,'textAlign');updateReaderPreview()"></div>
                  </div>
                </div>
                <div>
                  <div style="font-size:9px;font-weight:bold;margin-bottom:4px;color:var(--mac-gray-dark);">Preview</div>
                  <div id="readerPreview" style="background:#f5f5f0;border:1px solid var(--mac-black);height:140px;overflow:hidden;padding:8px;font-family:Georgia,serif;">
                    <p style="margin:0;">It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness...</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Images Panel -->
        <div class="file-panel" id="panel-images">
          <div class="upload-zone" onclick="this.querySelector('input').click()" ondragover="event.preventDefault();this.classList.add('dragover')" ondragleave="this.classList.remove('dragover')" ondrop="handleDrop(event,'images')">
            <div class="icon">ğŸ–¼ï¸</div>
            <div class="text">Drop images here</div>
            <div class="hint">Supports: BMP (1-bit or 24-bit)</div>
            <input type="file" accept=".bmp" multiple onchange="uploadFiles(this.files,'images')">
          </div>
          <div class="card">
            <div class="card-header"><span class="card-title">Your Images</span><button class="btn btn-sm btn-secondary" onclick="refreshFiles('images')">ğŸ”„</button></div>
            <div class="card-body">
              <div class="file-grid" id="imageGrid">
                <div class="file-empty"><div class="icon">ğŸ–¼ï¸</div><div>No images yet</div></div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Maps Panel -->
        <div class="file-panel" id="panel-maps">
          <div class="upload-zone" onclick="this.querySelector('input').click()" ondragover="event.preventDefault();this.classList.add('dragover')" ondragleave="this.classList.remove('dragover')" ondrop="handleDrop(event,'maps')">
            <div class="icon">ğŸ—ºï¸</div>
            <div class="text">Drop map images here</div>
            <div class="hint">Supports: PNG, BMP, JPG</div>
            <input type="file" accept=".png,.bmp,.jpg,.jpeg" multiple onchange="uploadFiles(this.files,'maps')">
          </div>
          <div class="card">
            <div class="card-header"><span class="card-title">Your Maps</span><button class="btn btn-sm btn-secondary" onclick="refreshFiles('maps')">ğŸ”„</button></div>
            <div class="card-body">
              <div class="file-grid" id="mapGrid">
                <div class="file-empty"><div class="icon">ğŸ—ºï¸</div><div>No maps yet</div></div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Flashcards Panel -->
        <div class="file-panel" id="panel-flashcards">
          <div class="btn-group mb-8">
            <button class="btn btn-primary" onclick="showCreateDeckModal()">â• Create Deck</button>
            <button class="btn btn-secondary" onclick="document.getElementById('ankiImport').click()">ğŸ“¥ Import</button>
            <input type="file" id="ankiImport" accept=".txt,.csv,.apkg" style="display:none" onchange="importAnkiDeck(this.files[0])">
          </div>
          <div class="card">
            <div class="card-header"><span class="card-title">Your Decks</span><button class="btn btn-sm btn-secondary" onclick="refreshFiles('flashcards')">ğŸ”„</button></div>
            <div class="card-body">
              <div id="deckList">
                <div class="file-empty"><div class="icon">ğŸ´</div><div>No decks yet</div></div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Notes Panel -->
        <div class="file-panel" id="panel-notes">
          <div class="btn-group mb-8">
            <button class="btn btn-primary" onclick="createNewNote()">ğŸ“ New Note</button>
          </div>
          <div class="card">
            <div class="card-header"><span class="card-title">Your Notes</span><button class="btn btn-sm btn-secondary" onclick="refreshFiles('notes')">ğŸ”„</button></div>
            <div class="card-body">
              <div class="file-grid" id="noteGrid">
                <div class="file-empty"><div class="icon">ğŸ“</div><div>No notes yet</div></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== WEATHER PAGE ==================== -->
      <div class="page" id="page-weather">
        <div class="page-header">
          <h1 class="page-title">Weather Settings</h1>
          <p class="page-desc">Configure weather display</p>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Location</span></div>
          <div class="card-body">
            <div id="weatherLocation" class="mb-8 text-muted">Auto-detected from IP</div>
            <div class="form-row">
              <label>ZIP Code:</label>
              <input type="text" class="text-input" id="weatherZip" placeholder="e.g. 80424" style="width:80px;">
              <button class="btn btn-sm" onclick="saveWeatherZip()">Set</button>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Timezone</span></div>
          <div class="card-body">
            <select id="timezoneSelect" style="width:100%;" onchange="saveTimezone()">
              <option value="auto">Auto-detect from IP</option>
              <option value="-18000">Eastern (UTC-5)</option>
              <option value="-21600">Central (UTC-6)</option>
              <option value="-25200">Mountain (UTC-7)</option>
              <option value="-28800">Pacific (UTC-8)</option>
              <option value="0">UTC</option>
            </select>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Units</span></div>
          <div class="card-body">
            <div class="toggle">
              <span class="toggle-label">Use Celsius (Â°C)</span>
              <div class="toggle-switch" id="togCelsius" onclick="toggleOpt(this,'useCelsius')"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== DISPLAY PAGE ==================== -->
      <div class="page" id="page-display">
        <div class="page-header">
          <h1 class="page-title">Display Settings</h1>
          <p class="page-desc">Configure your e-ink display</p>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Display Options</span></div>
          <div class="card-body">
            <div class="toggle">
              <div><span class="toggle-label">Landscape Mode</span><div class="toggle-desc">Rotate display 90Â°</div></div>
              <div class="toggle-switch" id="togLandscape" onclick="toggleOpt(this,'landscape')"></div>
            </div>
            <div class="toggle">
              <div><span class="toggle-label">Invert Colors</span><div class="toggle-desc">Dark background, light text</div></div>
              <div class="toggle-switch" id="togInvert" onclick="toggleOpt(this,'invertColors')"></div>
            </div>
            <div class="toggle">
              <div><span class="toggle-label">Boot to Last Book</span><div class="toggle-desc">Resume reading on startup</div></div>
              <div class="toggle-switch" id="togBootToBook" onclick="toggleOpt(this,'bootToLastBook')"></div>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Auto-Sleep</span></div>
          <div class="card-body">
            <div class="slider-row">
              <span class="slider-label">Sleep after:</span>
              <input type="range" class="slider-input" id="sleepSlider" min="5" max="60" step="5" value="15" oninput="updateSlider(this,'sleepVal',' min')">
              <span class="slider-value" id="sleepVal">15 min</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== BLUETOOTH PAGE ==================== -->
      <div class="page" id="page-bluetooth">
        <div class="page-header">
          <h1 class="page-title">Keyboard Settings</h1>
          <p class="page-desc">Connect Bluetooth keyboards and page turners</p>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Bluetooth</span></div>
          <div class="card-body">
            <div class="toggle">
              <div><span class="toggle-label">Enable Bluetooth</span><div class="toggle-desc">Allow BT connections</div></div>
              <div class="toggle-switch" id="togBTEnabled" onclick="toggleBT(this)"></div>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Paired Devices</span></div>
          <div class="card-body" id="btPaired">
            <div class="text-center text-muted">No devices paired yet</div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <span class="card-title">Available Devices</span>
            <button class="btn btn-sm btn-secondary" id="btScanBtn" onclick="scanBT()">ğŸ” Scan</button>
          </div>
          <div class="card-body" id="btDiscovered">
            <div class="text-center text-muted">Click Scan to search</div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Keyboard Layout</span></div>
          <div class="card-body">
            <select id="kbLayout" style="width:100%;">
              <option>US English (QWERTY)</option>
              <option>UK English</option>
              <option>German (QWERTZ)</option>
              <option>French (AZERTY)</option>
            </select>
          </div>
        </div>
      </div>

      <!-- ==================== POWER PAGE ==================== -->
      <div class="page" id="page-power">
        <div class="page-header">
          <h1 class="page-title">Power</h1>
          <p class="page-desc">Battery status and power settings</p>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Battery Status</span></div>
          <div class="card-body text-center">
            <div style="font-size:48px;">ğŸ”‹</div>
            <div style="font-size:28px;font-weight:bold;" id="powerPercent">--%</div>
            <div class="text-muted" id="powerVolts">-- V</div>
            <div class="progress" style="margin-top:12px;">
              <div class="progress-bar" id="powerBar" style="width:0%;"></div>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Power Settings</span></div>
          <div class="card-body">
            <div class="toggle">
              <div><span class="toggle-label">Deep Sleep Mode</span><div class="toggle-desc">Lower power consumption when sleeping</div></div>
              <div class="toggle-switch on" id="togDeepSleep" onclick="toggleOpt(this,'deepSleep')"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== ABOUT PAGE ==================== -->
      <div class="page" id="page-about">
        <div class="page-header">
          <h1 class="page-title">About</h1>
          <p class="page-desc">Device information and system tools</p>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Device Information</span></div>
          <div class="card-body">
            <table style="width:100%;font-size:11px;">
              <tr><td class="text-muted" style="padding:4px 0">Firmware</td><td style="text-align:right" id="aboutFirmware">--</td></tr>
              <tr><td class="text-muted" style="padding:4px 0">Hardware</td><td style="text-align:right">ESP32-C3</td></tr>
              <tr><td class="text-muted" style="padding:4px 0">Display</td><td style="text-align:right">GDEQ0426T82 4.26"</td></tr>
              <tr><td class="text-muted" style="padding:4px 0">Resolution</td><td style="text-align:right">800Ã—480</td></tr>
              <tr><td class="text-muted" style="padding:4px 0">SD Card</td><td style="text-align:right" id="aboutSD">--</td></tr>
              <tr><td class="text-muted" style="padding:4px 0">Free Memory</td><td style="text-align:right" id="aboutMem">--</td></tr>
              <tr><td class="text-muted" style="padding:4px 0">Uptime</td><td style="text-align:right" id="aboutUptime">--</td></tr>
            </table>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">System Actions</span></div>
          <div class="card-body">
            <div class="btn-group">
              <button class="btn btn-secondary" onclick="refreshDisplay()">ğŸ”„ Refresh Display</button>
              <button class="btn btn-secondary" onclick="rebootDevice()">ğŸ”ƒ Reboot</button>
              <button class="btn btn-danger" onclick="factoryReset()">ğŸ—‘ï¸ Factory Reset</button>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header"><span class="card-title">Backup & Restore</span></div>
          <div class="card-body">
            <div class="btn-group">
              <button class="btn btn-secondary" onclick="downloadBackup()">ğŸ“¥ Download Backup</button>
              <button class="btn btn-secondary" onclick="document.getElementById('restoreFile').click()">ğŸ“¤ Restore</button>
              <input type="file" id="restoreFile" accept=".json" style="display:none" onchange="restoreBackup(this.files[0])">
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <!-- Action Bar (inside window) -->
  <div class="action-bar">
    <button class="btn btn-secondary" onclick="resetToDefaults()">â†©ï¸ Reset</button>
    <button class="btn btn-primary" id="deployBtn" onclick="saveAndDeploy()">ğŸ’¾ Save & Deploy</button>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- WiFi Modal -->
<div class="modal" id="wifiModal">
  <div class="modal-content">
    <div class="modal-header">Connect to WiFi</div>
    <div class="modal-body">
      <p class="mb-8">Network: <strong id="wifiModalSSID"></strong></p>
      <div class="input-row">
        <label>Password:</label>
        <input type="password" class="text-input" id="wifiPassword" style="flex:1;" onkeypress="if(event.key==='Enter')connectWifi()">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('wifiModal')">Cancel</button>
      <button class="btn btn-primary" onclick="connectWifi()">Connect</button>
    </div>
  </div>
</div>
